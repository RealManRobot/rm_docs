# 机械臂配置-运动参数命令集

本命令集用于配置机械臂末端的线速度、线加速度、角速度、角加速度、碰撞等级的设置与查询、初始化机械臂参数、设置、恢复和查询机械臂DH参数、重设机关节零位补偿等。
机械臂末端参数设置完毕后，基础系列需要调用[参数保存（基础系列）](../系统配置/系统指令.md#参数保存基础系列)手动保存到控制器Flash，否则断电之后不会保存。
<div style="height: 2px; background-image: linear-gradient(to right, #ccc, #ccc); margin: 1em 0;"></div>

## 设置机械臂末端最大线速度

**参数说明：**

| 参数                     | 类型 | 说明                       |
| :----------------------- | :--- | :------------------------- |
| `set_arm_max_line_speed` |   `string`   | 设置机械臂末端最大线速度。 |
| `arm_line_speed`           |   `int`   | 目标线速度单位：m/s。      |

> 注意：建议使用默认最大线速度，如需更改，设置的机械臂末端最大线加速度与最大线速度的比值需要≥3，否则可能出现运动异常

**使用示例：**
实现：设置机械臂末端最大线速度0.5m/s，分辨率0.001m/s。

```json
{"command":"set_arm_max_line_speed","arm_line_speed":500}
```

**返回示例：**

```json
{"command":"set_arm_max_line_speed","arm_line_speed":true}
```

| 参数             | 类型   | 说明                                  |
| :--------------- | :----- | :------------------------------------ |
| `arm_line_speed` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 设置机械臂末端最大线加速度

**参数说明：**

| 参数                   | 类型 | 说明                         |
| :--------------------- | :--- | :--------------------------- |
| `set_arm_max_line_acc` |   `string`   | 设置机械臂末端最大线加速度。 |
| `arm_line_acc`         |   `int`   | 目标线加速度单位：m/s²。     |

> 注意：建议使用默认最大线加速度，如需更改，设置的机械臂末端最大线加速度与最大线速度的比值需要≥3，否则可能出现运动异常

**使用示例：**
实现：设置机械臂末端最大线加速度2m/s²，分辨率0.001m/s²。

```json
{"command":"set_arm_max_line_acc","arm_line_acc":2000}
```

**返回示例：**

```json
{"command":"set_arm_max_line_acc","arm_line_acc":true}
```

| 参数           | 类型   | 说明                                  |
| :------------- | :----- | :------------------------------------ |
| `arm_line_acc` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 设置机械臂末端最大角速度

**参数说明：**

| 参数                        | 类型 | 说明                       |
| :-------------------------- | :--- | :------------------------- |
| `set_arm_max_angular_speed` |   `string`   | 设置机械臂末端最大角速度。 |
| `arm_angular_speed`         |   `int`   | 目标角速度单位：rad/s。   |

> 注意：建议使用默认最大角速度，如需更改，设置的机械臂末端最大角加速度与最大角速度的比值需要≥3，否则可能出现运动异常

**使用示例：**
实现：设置机械臂末端最大角速度0.2rad/s，分辨率0.001rad/s。

```json
{"command":"set_arm_max_angular_speed","arm_angular_speed":200}
```

**返回示例：**

```json
{"command":"set_arm_max_angular_speed","arm_angular_speed":true}
```

| 参数                | 类型   | 说明                                  |
| :------------------ | :----- | :------------------------------------ |
| `arm_angular_speed` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 设置机械臂末端最大角加速度

**参数说明：**

| 参数                      | 类型 | 说明                         |
| :------------------------ | :--- | :--------------------------- |
| `set_arm_max_angular_acc` |   `string`   | 设置机械臂末端最大角加速度。 |
| `arm_angular_acc`         |   `int`   | 目标角加速度单位：rad/s²。   |

> 注意：建议使用默认最大角加速度，如需更改，设置的机械臂末端最大角加速度与最大角速度的比值需要≥3，否则可能出现运动异常

**使用示例：**
实现：设置机械臂末端最大角加速度4rad/s²，分辨率0.001rad/s²。

```json
{"command":"set_arm_max_angular_acc","arm_angular_acc":4000}
```

**返回示例：**

```json
{"command":"set_arm_max_angular_acc","arm_angular_acc":true}
```

| 参数              | 类型   | 说明                                  |
| :---------------- | :----- | :------------------------------------ |
| `arm_angular_acc` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 初始化机械臂参数

**参数说明：**

| 参数                      | 类型 | 说明                       |
| :------------------------ | :--- | :------------------------- |
| `set_arm_max_angular_acc` |   `string`   | 初始化机械臂参数。         |

**使用示例：**
实现：初始化机械臂参数，机械臂的末端参数恢复到默认值。
末端线速度：0.25m/s;    末端线加速度：1.6m/s²;
末端角速度：0.6rad/s;   末端角加速度：4rad/s²。

```json
{"command":"set_arm_init"}
```

**返回示例：**

```json
{"command":"set_arm_init","arm_init":true}
```

| 参数       | 类型   | 说明                                  |
| :--------- | :----- | :------------------------------------ |
| `arm_init` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 设置碰撞防护等级

**参数说明：**

| 参数                  | 类型 | 说明                     |
| :-------------------- | :--- | :----------------------- |
| `set_collision_stage` |   `string`   | 设置机械臂碰撞防护等级。 |
| `collision_stage`     |   `int`   | 等级，范围：0~8。        |

**使用示例：**
实现：设置机械臂碰撞防护等级1，等级越高，检测越灵敏。

```json
{"command":"set_collision_stage","collision_stage":1}
```

**返回示例：**

```json
{"command":"set_collision_state","collision_state":true}
```

| 参数              | 类型   | 说明                                  |
| :---------------- | :----- | :------------------------------------ |
| `collision_state` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 查询碰撞防护等级

**参数说明：**

| 参数                  | 类型 | 说明               |
| :-------------------- | :--- | :----------------- |
| `get_collision_stage` |   `string`   | 查询碰撞防护等级。 |

**使用示例：**
实现：查询碰撞防护等级。

```json
{"command":"get_collision_stage"}
```

**返回示例：**

```json
{"state":"get_collision_stage","collision_stage":5}
```

| 参数              | 类型  | 说明              |
| :---------------- | :---- | :---------------- |
| `collision_stage` | `int` | 等级，范围：0~8。 |

## 重新设置机械臂DH参数（I系列）

**参数说明：**

| 参数                  | 类型 | 说明                   |
| :-------------------- | :--- | :--------------------- |
| `set_DH_data` |   `int`   | 重新设置机械臂DH参数。 |

> 注意：该指令用户不可自行使用，必须配合测量设备进行绝对精度补偿时方可使用，否则会导致机械臂参数错误！

**使用示例：**
实现：每个关节有四组数据，分别表示alpha、a、d、offset，示例中表示1°、0.002m、0.003m和4°。

```json
//6自由度机械臂
{
    "command":"set_DH_data",
    "joint_1":[1000,2000,3000,4000],
    "joint_2":[1000,2000,3000,4000],
    "joint_3":[1000,2000,3000,4000],
    "joint_4":[1000,2000,3000,4000],
    "joint_5":[1000,2000,3000,4000],
    "joint_6":[1000,2000,3000,4000]
}
//7自由度机械臂
{
    "command":"set_DH_data",
    "joint_1":[1000,2000,3000,4000],
    "joint_2":[1000,2000,3000,4000],
    "joint_3":[1000,2000,3000,4000],
    "joint_4":[1000,2000,3000,4000],
    "joint_5":[1000,2000,3000,4000],
    "joint_6":[1000,2000,3000,4000],
    "joint_7":[1000,2000,3000,4000]
}
```

**返回示例：**

```json
{"command":"set_DH_data","set_state":true}
```

| 参数        | 类型   | 说明                                  |
| :---------- | :----- | :------------------------------------ |
| `set_state` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 查询机械臂DH参数（I系列）

**参数说明：**

| 参数                  | 类型 | 说明               |
| :-------------------- | :--- | :----------------- |
| `get_DH_data` |   `string`   | 查询机械臂DH参数。 |

**使用示例：**
实现：查询机械臂DH参数。

```json
{"command":"get_DH_data"} 
```

**返回示例：**

```json
//6自由度机械臂
{
    "command":"set_DH_data",
    "joint_1":[1000,2000,3000,4000],
    "joint_2":[1000,2000,3000,4000],
    "joint_3":[1000,2000,3000,4000],
    "joint_4":[1000,2000,3000,4000],
    "joint_5":[1000,2000,3000,4000],
    "joint_6":[1000,2000,3000,4000]
}
//7自由度机械臂
{
    "command":"set_DH_data",
    "joint_1":[1000,2000,3000,4000],
    "joint_2":[1000,2000,3000,4000],
    "joint_3":[1000,2000,3000,4000],
    "joint_4":[1000,2000,3000,4000],
    "joint_5":[1000,2000,3000,4000],
    "joint_6":[1000,2000,3000,4000],
    "joint_7":[1000,2000,3000,4000]
}
```

| 参数      | 类型    | 说明                                                         |
| :-------- | :------ | :----------------------------------------------------------- |
| `joint_1` | `array` | 每个关节有四组数据，分别表示alpha、a、d、offset，示例中表示1°、0.002m、0.003m和4°。 |

## 恢复机械臂默认DH参数（I系列）

**参数说明：**

| 参数                  | 类型 | 说明                   |
| :-------------------- | :--- | :--------------------- |
| `set_DH_data_default` |   `string`   | 恢复机械臂默认DH参数。 |

**使用示例：**
实现：恢复机械臂默认DH参数。

```json
{"command":"set_DH_data_default"}
```

**返回示例：**

```json
{"command":"set_DH_data_default","set_state":true}
```

| 参数        | 类型   | 说明                                  |
| :---------- | :----- | :------------------------------------ |
| `set_state` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 重新设置关节零位补偿角度

重新设置关节零位补偿角度，用于校正绝对定位精度。

**参数说明：**

| 参数                    | 类型 | 说明                       |
| :---------------------- | :--- | :------------------------- |
| `set_joint_zero_offset` |   `int`   | 重新设置关节零位补偿角度。 |

> 注意：该指令用户不可自行使用，必须配合测量设备进行绝对精度补偿时方可使用，否则会导致机械臂参数错误！

**使用示例：**
实现：设置关节零位偏移，精度：0.001°关节1~6的零位补偿角度：1°，-2°，3°，-4°，5°，-6°。

```json
{"command":"set_joint_zero_offset","offset":[1000,-2000,3000,-4000,5000,-6000]}
```

**返回示例：**

```json
{"command":"set_joint_zero_offset","set_state":true}
```

| 参数        | 类型   | 说明                                  |
| :---------- | :----- | :------------------------------------ |
| `set_state` | `bool` | `ture`：设置成功；`false`：设置失败。 |
