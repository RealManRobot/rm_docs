# 机械臂配置-工具坐标系命令集

## 自动计算工具坐标系（标定参考点）

自动计算工具坐标系（六点法）：机械臂只能存储10个工具坐标系，若超过10个，则新建立工具不成功。

**参数说明：**

| 参数                  | 类型 | 说明               |
| :-------------------- | :--- | :----------------- |
| `set_auto_tool_frame` |      | 一键设置关节限位。 |
| `point_num`           |      | 1~6为标定参考点。  |

**使用示例：**
实现：自动计算工具坐标系，标定当前位置为参考点6。备注：机械臂上电初始化后，默认无负载。

```json
{"command":"set_auto_tool_frame","point_num":1}
{"command":"set_auto_tool_frame","point_num":2}
{"command":"set_auto_tool_frame","point_num":3}
{"command":"set_auto_tool_frame","point_num":4}
{"command":"set_auto_tool_frame","point_num":5}
{"command":"set_auto_tool_frame","point_num":6}
```

**返回示例：**

```json
{"command":"set_auto_tool_frame","auto_tool_frame":true}
```

| 参数              | 类型   | 说明                                  |
| :---------------- | :----- | :------------------------------------ |
| `auto_tool_frame` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 自动计算工具坐标系（自动计算生成工具）

自动计算工具坐标系（六点法）：机械臂只能存储10个工具坐标系，若超过10个，则新建立工具不成功。

**参数说明：**

| 参数                  | 类型 | 说明                               |
| :-------------------- | :--- | :--------------------------------- |
| `set_auto_tool_frame` |      | 自动计算工具坐标系。               |
| `tool_name`           |      | 工具坐标系名称，不能超过10个字符。 |
| `payload`             |      | 单位：g，最高不超过5000g           |
| position              |      | 质心位置，单位：mm，精度0.001mm    |

**使用示例：**
实现：自动计算工具坐标系，名称tool2_frame，标定当前位置为参考点6,末端负载5000g，质心位置：x-1mm,y-2mm,z-3mm
备注：机械臂上电初始化后，默认无负载。

```json
{"command":"set_auto_tool_frame","tool_name":"tool_frame","payload":5000,"position":[1000,2000,3000]}
```

**返回示例：**

```json
{"command":"set_auto_tool_frame","auto_tool_frame":true}
```

| 参数              | 类型   | 说明                                  |
| :---------------- | :----- | :------------------------------------ |
| `auto_tool_frame` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 自动计算工具坐标系（自动计算生成工具）

自动计算工具坐标系（六点法）：机械臂只能存储10个工具坐标系，若超过10个，则新建立工具不成功。

**参数说明：**

| 参数                  | 类型 | 说明                               |
| :-------------------- | :--- | :--------------------------------- |
| `set_auto_tool_frame` |      | 自动计算工具坐标系。               |
| `tool_name`           |      | 工具坐标系名称，不能超过10个字符。 |
| `payload`             |      | 单位：g，最高不超过5000g           |
| position              |      | 质心位置，单位：mm，精度0.001mm    |

**使用示例：**
实现：自动计算工具坐标系，
名称tool2_frame，
标定当前位置为参考点6,末端负载5000g，
质心位置：x-1mm,y-2mm,z-3mm
备注：机械臂上电初始化后，默认无负载。

```json
{"command":"set_auto_tool_frame","tool_name":"tool_frame","payload":5000,"position":[1000,2000,3000]}
```

**返回示例：**

```json
{"command":"set_auto_tool_frame","auto_tool_frame":true}
```

| 参数              | 类型   | 说明                                  |
| :---------------- | :----- | :------------------------------------ |
| `auto_tool_frame` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 手动输入工具坐标系

自动计算工具坐标系（六点法）：机械臂只能存储10个工具坐标系，若超过10个，则新建立工具不成功。

**参数说明：**

| 参数                  | 类型 | 说明                               |
| :-------------------- | :--- | :--------------------------------- |
| `set_auto_tool_frame` |      | 自动计算工具坐标系。               |
| `tool_name`           |      | 工具坐标系名称，不能超过10个字符。 |
| `payload`             |      | 单位：g，最高不超过5000g           |
| position              |      | 质心位置，单位：mm，精度0.001mm    |

**使用示例：**

实现：手动输入工具坐标系，
名称tool_frame，
工具位置：x：0.1m，y:0.2m，z：0.03m，
位置精度：0.001mm工具姿态：rx：0.4rad，ry：0.5rad，rz：0.6rad，
姿态精度：0.001rad末端负载5000g，
质心位置：x-1mm,y-2mm,z-3mm
payload：单位：g，最高不超过5000g；
position：质心位置，单位：mm，精度0.001mm
备注：机械臂上电初始化后，默认无负载。

```json
{
    "command":"set_manual_tool_frame",
    "tool_name":"tool_frame",
    "tool_pose":[100000,200000,30000,400,500,600],
    "payload":5000,
    "position":[1000,2000,3000]
}
```

**返回示例：**

```json
{"command":"set_manual_tool_frame","manual_tool_frame":true}
```

| 参数                | 类型   | 说明                                  |
| :------------------ | :----- | :------------------------------------ |
| `manual_tool_frame` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 切换当前工具坐标系

切换当前工具坐标系。

**参数说明：**

| 参数                    | 类型 | 说明                               |
| :---------------------- | :--- | :--------------------------------- |
| `set_change_tool_frame` |      | 切换当前工具坐标系。               |
| `tool_name`             |      | 工具坐标系名称，不能超过10个字符。 |

**使用示例：**

实现：切换当前工具坐标系，名称tool2_frame。

```json
{"command":"set_change_tool_frame","tool_name":"tool2_frame"}
```

**返回示例：**

```json
{"command":"set_change_tool_frame","change_tool_frame":true}
```

| 参数                | 类型   | 说明                                  |
| :------------------ | :----- | :------------------------------------ |
| `change_tool_frame` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 删除工具坐标系

删除工具坐标系。

**参数说明：**

| 参数                    | 类型 | 说明                               |
| :---------------------- | :--- | :--------------------------------- |
| `set_delete_tool_frame` |      | 删除工具坐标系。                   |
| `tool_name`             |      | 工具坐标系名称，不能超过10个字符。 |

**使用示例：**

实现：删除工具坐标系，名称tool2_frame。

```json
{"command":"set_delete_tool_frame","tool_name":"tool2_frame"}
```

**返回示例：**

```json
{"command":"set_delete_tool_frame","delete_tool_frame":true}
```

| 参数                | 类型   | 说明                                  |
| :------------------ | :----- | :------------------------------------ |
| `delete_tool_frame` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 修改工具坐标系

修改工具坐标系。

**参数说明：**

| 参数                | 类型 | 说明                               |
| :------------------ | :--- | :--------------------------------- |
| `update_tool_frame` |      | 修改工具坐标系参数。               |
| `tool_name`         |      | 工具坐标系名称，不能超过10个字符。 |
| `tool_pose`         |      | 工具相对机械臂末端法兰中心位姿     |

**使用示例：**

实现：指定要修改的工具坐标系，
名称tool_frame，
工具位置：x：0.1m，y:0.2m，z：0.03m，
位置精度：0.001mm
工具姿态：rx：0.4rad，ry：0.5rad，rz：0.6rad，
姿态精度：0.001rad
末端负载5000g，
质心位置：x-1mm,y-2mm,z-3mm
payload：单位：g，最高不超过5000g；
position：质心位置，单位：mm，精度0.001mm。

```json
{
    "command":"update_tool_frame",
    "tool_name":"tool_frame",
    "tool_pose":[100000,200000,30000,400,500,600],
    "payload":5000,
    "position":[1000,2000,3000]
}
```

**返回示例：**

```json
{"command":"update_tool_frame","update_state":true}  
```

| 参数           | 类型   | 说明                                  |
| :------------- | :----- | :------------------------------------ |
| `update_state` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 设置工具坐标系包络参数

设置工具坐标系包络参数。

**参数说明：**

| 参数                | 类型 | 说明                               |
| :------------------ | :--- | :--------------------------------- |
| `update_tool_frame` |      | 设置工具坐标系包络参数。           |
| `tool_name`         |      | 工具坐标系名称，不能超过10个字符。 |
| `tool_pose`         |      | 工具相对机械臂末端法兰中心位姿     |

**使用示例：**

实现：tool_name：控制器中已存在的工具坐标系名称，如果不存在该字段，则为临时设置当前包络参数
list：包络参数列表，每个工具最多支持5个包络球，可以没有包络
name：工具包络球体的名称，1-10个字节，支持字母数字下划线
radius：工具包络球体的半径，单位0.001m，示例中left的半径为0.02m
x：工具包络球体球心基于末端法兰坐标系的X轴坐标，单位0.001m，示例中left的球心x坐标0.01m
y：工具包络球体球心基于末端法兰坐标系的Y轴坐标，单位0.001m，示例中left的球心y坐标0.02m
z：工具包络球体球心基于末端法兰坐标系的Z轴坐标，单位0.001m，示例中left的球心z坐标0.03m。

```json
{
    "command":"set_tool_envelope",
    "tool_name":"test",
    "list":[
        {"name":"left","radius":20,"x":10,"y":20,"z":30},
        {"name":"right","radius":30,"x":30,"y":40,"z":50},
        {"name":"center","radius":40,"x":50,"y":60,"z":70}
    ]
}
```

**返回示例：**

```json
 {"command":"set_tool_envelope","set_state",true} 
```

| 参数        | 类型   | 说明                                  |
| :---------- | :----- | :------------------------------------ |
| `set_state` | `bool` | `ture`：设置成功；`false`：设置失败。 |

## 查询工具坐标系包络参数

查询工具坐标系包络参数。

**参数说明：**

| 参数                | 类型 | 说明                               |
| :------------------ | :--- | :--------------------------------- |
| `update_tool_frame` |      | 查询工具坐标系包络参数。           |
| `tool_name`         |      | 工具坐标系名称，不能超过10个字符。 |
| `tool_pose`         |      | 工具相对机械臂末端法兰中心位姿     |

**使用示例：**

实现：tool_name：指定要查询的工具名称，如果不存在该字段，则为查询当前包络参数。

```json
{"command":"get_tool_envelope","tool_name":"tool1"}
```

**返回示例：**

```json
//查询结果 
{
    "command":"get_tool_envelope",
    "tool_name":"test",
    "list":[
        {
            "name":"left",
            "radius":20,"x":10,"y":20,"z":30
        },
        {
            "name":"right",
            "radius":30,"x":30,"y":40,"z":50
        },
        {
            "name":"center",
            "radius":40,"x":50,"y":60,"z":70
        }
    ]
}
//查询失败
{"command":"get_tool_envelope","get_state",false}
```

| 参数        | 类型     | 说明                                                         |
| :---------- | :------- | :----------------------------------------------------------- |
| `tool_name` | `string` | 控制器中已存在的工具坐标系名称。                             |
| `list`      | `array`  | 包络参数列表，每个工具最多支持5个包络球，可以没有包络        |
| `name`      | `string` | 工具包络球体的名称，1-10个字节，支持字母数字下划线           |
| `radius`    | `number` | 工具包络球体的半径，单位0.001m，示例中left的半径为0.02m      |
| `x`         | `number` | 工具包络球体球心基于末端法兰坐标系的X轴坐标，单0.001m，示例中left的球心x坐标0.01m |
| `y`         | `number` | 工具包络球体球心基于末端法兰坐标系的Y轴坐标，单位0.001m，示例中left的球心y坐标0.02m |
| `z`         | `number` | 工具包络球体球心基于末端法兰坐标系的Z轴坐标，单位0.001m，示例中left的球心z坐标0.03m |

